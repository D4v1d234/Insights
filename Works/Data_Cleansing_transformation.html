<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>9ad6d2b587d648c7900fdfdeef796f75</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="a5513a17" class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning and Transformation in the Python script</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Data Preparation:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - Loading Data: The dataset was loaded into the notebook and the structure of the first few rows was examined to understand the data.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Initial Cleaning: Preliminary cleaning steps were performed, including type conversion and handling of missing values as per the steps outlined in the Python script.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Data Exploration:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - Visualization: Various techniques such as bar charts, line graphs, and scatter plots were used to visualize data, identify trends, and understand patterns.</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - Statistical Analysis: Statistical methods were employed to explore relationships between variables, such as correlation analysis and hypothesis testing.</span></span></code></pre></div>
</div>
<div id="a43b7255" class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bokeh.io <span class="im">import</span> output_notebook, show</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bokeh.plotting <span class="im">import</span> figure</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bokeh.models <span class="im">import</span> ColumnDataSource, HoverTool</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bokeh.transform <span class="im">import</span> cumsum</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> pi</span></code></pre></div>
</div>
<div id="dc508b95" class="cell code" data-execution_count="19">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># File location</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="vs">r&#39;C:\Users\ddiol\OneDrive\Python\Project\Housing\Uk_House_1995_2023.csv&#39;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>{F887F88E-7D15-4415-804E-52EAC2F10958}</th>
      <th>70000</th>
      <th>1995-07-07 00:00</th>
      <th>MK15 9HP</th>
      <th>D</th>
      <th>N</th>
      <th>F</th>
      <th>31</th>
      <th>Unnamed: 8</th>
      <th>ALDRICH DRIVE</th>
      <th>WILLEN</th>
      <th>MILTON KEYNES</th>
      <th>MILTON KEYNES.1</th>
      <th>MILTON KEYNES.2</th>
      <th>A</th>
      <th>A.1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>{40FD4DF2-5362-407C-92BC-566E2CCE89E9}</td>
      <td>44500</td>
      <td>1995-02-03 00:00</td>
      <td>SR6 0AQ</td>
      <td>T</td>
      <td>N</td>
      <td>F</td>
      <td>50</td>
      <td>NaN</td>
      <td>HOWICK PARK</td>
      <td>SUNDERLAND</td>
      <td>SUNDERLAND</td>
      <td>SUNDERLAND</td>
      <td>TYNE AND WEAR</td>
      <td>A</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>{7A99F89E-7D81-4E45-ABD5-566E49A045EA}</td>
      <td>56500</td>
      <td>1995-01-13 00:00</td>
      <td>CO6 1SQ</td>
      <td>T</td>
      <td>N</td>
      <td>F</td>
      <td>19</td>
      <td>NaN</td>
      <td>BRICK KILN CLOSE</td>
      <td>COGGESHALL</td>
      <td>COLCHESTER</td>
      <td>BRAINTREE</td>
      <td>ESSEX</td>
      <td>A</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2</th>
      <td>{28225260-E61C-4E57-8B56-566E5285B1C1}</td>
      <td>58000</td>
      <td>1995-07-28 00:00</td>
      <td>B90 4TG</td>
      <td>T</td>
      <td>N</td>
      <td>F</td>
      <td>37</td>
      <td>NaN</td>
      <td>RAINSBROOK DRIVE</td>
      <td>SHIRLEY</td>
      <td>SOLIHULL</td>
      <td>SOLIHULL</td>
      <td>WEST MIDLANDS</td>
      <td>A</td>
      <td>A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>{444D34D7-9BA6-43A7-B695-4F48980E0176}</td>
      <td>51000</td>
      <td>1995-06-28 00:00</td>
      <td>DY5 1SA</td>
      <td>S</td>
      <td>N</td>
      <td>F</td>
      <td>59</td>
      <td>NaN</td>
      <td>MERRY HILL</td>
      <td>BRIERLEY HILL</td>
      <td>BRIERLEY HILL</td>
      <td>DUDLEY</td>
      <td>WEST MIDLANDS</td>
      <td>A</td>
      <td>A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>{AE76CAF1-F8CC-43F9-8F63-4F48A2857D41}</td>
      <td>17000</td>
      <td>1995-03-10 00:00</td>
      <td>S65 1QJ</td>
      <td>T</td>
      <td>N</td>
      <td>L</td>
      <td>22</td>
      <td>NaN</td>
      <td>DENMAN STREET</td>
      <td>ROTHERHAM</td>
      <td>ROTHERHAM</td>
      <td>ROTHERHAM</td>
      <td>SOUTH YORKSHIRE</td>
      <td>A</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="1dbd0333" class="cell code" data-execution_count="23"
data-scrolled="true">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 28276227 entries, 0 to 28276226
Data columns (total 16 columns):
 #   Column                                  Dtype 
---  ------                                  ----- 
 0   {F887F88E-7D15-4415-804E-52EAC2F10958}  object
 1   70000                                   int64 
 2   1995-07-07 00:00                        object
 3   MK15 9HP                                object
 4   D                                       object
 5   N                                       object
 6   F                                       object
 7   31                                      object
 8   Unnamed: 8                              object
 9   ALDRICH DRIVE                           object
 10  WILLEN                                  object
 11  MILTON KEYNES                           object
 12  MILTON KEYNES.1                         object
 13  MILTON KEYNES.2                         object
 14  A                                       object
 15  A.1                                     object
dtypes: int64(1), object(15)
memory usage: 3.4+ GB
</code></pre>
</div>
</div>
<div id="e9c55327" class="cell code" data-execution_count="4">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Copying the DataFrame: Creates a copy of the original DataFrame to preserve the original data. This is a good practice to avoid unintentional modifications.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming Columns: Standardizes column names to ensure consistency and clarity, especially if the original names are unclear or not user-friendly. The new names appear to be based on a standard naming convention from the ONS (Office for National Statistics) website.</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking Data: df1.info() is used again to verify the changes and ensure the renaming process has been correctly applied.</span></span></code></pre></div>
<div class="output error" data-ename="SyntaxError"
data-evalue="invalid syntax (1297238610.py, line 1)">
<pre><code>  Cell In[4], line 1
    &gt; Copying the DataFrame: Creates a copy of the original DataFrame to preserve the original data. This is a good practice to avoid unintentional modifications.
    ^
SyntaxError: invalid syntax

</code></pre>
</div>
</div>
<div id="afac2e3b" class="cell code" data-execution_count="26"
data-scrolled="true">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the DataFrame</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df.copy()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the new column names based on ONS website</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>column_names <span class="op">=</span> [<span class="st">&#39;Transaction_unique_identifier&#39;</span>, <span class="st">&#39;Price&#39;</span>, <span class="st">&#39;Date_of_Transfer&#39;</span>, <span class="st">&#39;Postcode&#39;</span>, <span class="st">&#39;Property_Type&#39;</span>, <span class="st">&#39;Old/New&#39;</span>, <span class="st">&#39;Duration&#39;</span>, <span class="st">&#39;PAON&#39;</span>, <span class="st">&#39;SAON&#39;</span>, <span class="st">&#39;Street&#39;</span>, <span class="st">&#39;Locality&#39;</span>, <span class="st">&#39;Town/City&#39;</span>, <span class="st">&#39;District&#39;</span>, <span class="st">&#39;County&#39;</span>, <span class="st">&#39;Transaction_type&#39;</span>, <span class="st">&#39;Record_status&#39;</span>]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the columns</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>df1.columns <span class="op">=</span> column_names</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>df1.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 28276227 entries, 0 to 28276226
Data columns (total 16 columns):
 #   Column                         Dtype 
---  ------                         ----- 
 0   Transaction_unique_identifier  object
 1   Price                          int64 
 2   Date_of_Transfer               object
 3   Postcode                       object
 4   Property_Type                  object
 5   Old/New                        object
 6   Duration                       object
 7   PAON                           object
 8   SAON                           object
 9   Street                         object
 10  Locality                       object
 11  Town/City                      object
 12  District                       object
 13  County                         object
 14  Transaction_type               object
 15  Record_status                  object
dtypes: int64(1), object(15)
memory usage: 3.4+ GB
</code></pre>
</div>
</div>
<div id="e8b9e234" class="cell code">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifying Missing Values: Using isnull() or similar methods to locate NaNs or missing entries.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filling Missing Values: Using techniques such as forward fill, backward fill, or imputation based on statistical measures (mean, median, mode).</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Dropping Missing Values: Removing rows or columns that contain a significant amount of missing data.</span></span></code></pre></div>
</div>
<div id="a18c4b1b" class="cell code" data-execution_count="27">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop missing values in &#39;Postcode&#39; column</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df1.dropna(subset<span class="op">=</span>[<span class="st">&#39;Postcode&#39;</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill missing values in &#39;SAON&#39;, &#39;Street&#39;, and &#39;Locality&#39; columns using .loc</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>df1.loc[:, <span class="st">&#39;SAON&#39;</span>] <span class="op">=</span> df1[<span class="st">&#39;SAON&#39;</span>].fillna(<span class="st">&#39;Unknown&#39;</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>df1.loc[:, <span class="st">&#39;Street&#39;</span>] <span class="op">=</span> df1[<span class="st">&#39;Street&#39;</span>].fillna(<span class="st">&#39;Unknown&#39;</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>df1.loc[:, <span class="st">&#39;Locality&#39;</span>] <span class="op">=</span> df1[<span class="st">&#39;Locality&#39;</span>].fillna(<span class="st">&#39;Unknown&#39;</span>)</span></code></pre></div>
</div>
<div id="29a8b45b" class="cell code">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Data Type Conversion</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Another essential step involves converting data types to appropriate formats, such as ensuring dates are in datetime format and numerical values are correctly identified. This ensures that subsequent analysis and visualizations are accurate.</span></span></code></pre></div>
</div>
<div id="46a13816" class="cell code" data-execution_count="28">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert &#39;Date_of_Transfer&#39; to datetime</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;Date_of_Transfer&#39;</span>] <span class="op">=</span> pd.to_datetime(df1[<span class="st">&#39;Date_of_Transfer&#39;</span>])</span></code></pre></div>
</div>
<div id="fa099215" class="cell code" data-execution_count="29">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract date components</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;Date&#39;</span>] <span class="op">=</span> df1[<span class="st">&#39;Date_of_Transfer&#39;</span>].dt.date</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;Day&#39;</span>] <span class="op">=</span> df1[<span class="st">&#39;Date_of_Transfer&#39;</span>].dt.day</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;Month&#39;</span>] <span class="op">=</span> df1[<span class="st">&#39;Date_of_Transfer&#39;</span>].dt.month</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;Year&#39;</span>] <span class="op">=</span> df1[<span class="st">&#39;Date_of_Transfer&#39;</span>].dt.year</span></code></pre></div>
</div>
<div id="73690052" class="cell code" data-execution_count="30">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df1.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 28230258 entries, 0 to 28230257
Data columns (total 20 columns):
 #   Column                         Dtype         
---  ------                         -----         
 0   Transaction_unique_identifier  object        
 1   Price                          int64         
 2   Date_of_Transfer               datetime64[ns]
 3   Postcode                       object        
 4   Property_Type                  object        
 5   Old/New                        object        
 6   Duration                       object        
 7   PAON                           object        
 8   SAON                           object        
 9   Street                         object        
 10  Locality                       object        
 11  Town/City                      object        
 12  District                       object        
 13  County                         object        
 14  Transaction_type               object        
 15  Record_status                  object        
 16  Date                           object        
 17  Day                            int32         
 18  Month                          int32         
 19  Year                           int32         
dtypes: datetime64[ns](1), int32(3), int64(1), object(15)
memory usage: 3.9+ GB
</code></pre>
</div>
</div>
<div id="35c07aa8" class="cell code" data-execution_count="32"
data-scrolled="true">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate count of entries per county</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>county_count <span class="op">=</span> df1[<span class="st">&#39;County&#39;</span>].value_counts().reset_index()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the columns</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>county_count.columns <span class="op">=</span> [<span class="st">&#39;County&#39;</span>, <span class="st">&#39;count&#39;</span>]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display DataFrame information</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>county_count.info()</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the DataFrame to see the counts</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(county_count)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 132 entries, 0 to 131
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   County  132 non-null    object
 1   count   132 non-null    int64 
dtypes: int64(1), object(1)
memory usage: 2.2+ KB
                      County    count
0             GREATER LONDON  3616913
1         GREATER MANCHESTER  1255202
2              WEST MIDLANDS  1077364
3             WEST YORKSHIRE  1074166
4                       KENT   801625
..                       ...      ...
127          SOUTH GLAMORGAN     1770
128                CLEVELAND     1762
129          ISLES OF SCILLY      628
130               CUMBERLAND      448
131  WESTMORLAND AND FURNESS      340

[132 rows x 2 columns]
</code></pre>
</div>
</div>
<div id="fdd0b660" class="cell code">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List of Counties was printed for clustering by Region</span></span></code></pre></div>
</div>
<div id="8ed9e45a" class="cell code" data-execution_count="33"
data-scrolled="true">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a list of unique entries in the &#39;County&#39; column</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>unique_counties <span class="op">=</span> df1[<span class="st">&#39;County&#39;</span>].unique().tolist()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the list of unique counties</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(unique_counties)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;TYNE AND WEAR&#39;, &#39;ESSEX&#39;, &#39;WEST MIDLANDS&#39;, &#39;SOUTH YORKSHIRE&#39;, &#39;CAMBRIDGESHIRE&#39;, &#39;CHESHIRE&#39;, &#39;SWANSEA&#39;, &#39;NORFOLK&#39;, &#39;STAFFORDSHIRE&#39;, &#39;GLOUCESTERSHIRE&#39;, &#39;GREATER LONDON&#39;, &#39;MERSEYSIDE&#39;, &#39;BLACKPOOL&#39;, &#39;NORTHUMBERLAND&#39;, &#39;WORCESTERSHIRE&#39;, &#39;LINCOLNSHIRE&#39;, &#39;AVON&#39;, &#39;OXFORDSHIRE&#39;, &#39;SURREY&#39;, &#39;LUTON&#39;, &#39;GREATER MANCHESTER&#39;, &#39;EAST SUSSEX&#39;, &#39;LEICESTERSHIRE&#39;, &#39;NORTHAMPTONSHIRE&#39;, &#39;BUCKINGHAMSHIRE&#39;, &#39;DERBYSHIRE&#39;, &#39;HEREFORD AND WORCESTER&#39;, &#39;KENT&#39;, &#39;NOTTINGHAMSHIRE&#39;, &#39;SOMERSET&#39;, &#39;HUMBERSIDE&#39;, &#39;BOURNEMOUTH&#39;, &#39;HAMPSHIRE&#39;, &#39;WEST SUSSEX&#39;, &#39;GWENT&#39;, &#39;WOKINGHAM&#39;, &#39;NEWPORT&#39;, &#39;LANCASHIRE&#39;, &#39;STOKE-ON-TRENT&#39;, &#39;SUFFOLK&#39;, &#39;SOUTHEND-ON-SEA&#39;, &#39;WINDSOR AND MAIDENHEAD&#39;, &#39;STOCKTON-ON-TEES&#39;, &#39;NORTH YORKSHIRE&#39;, &#39;WEST YORKSHIRE&#39;, &#39;WARWICKSHIRE&#39;, &#39;SHROPSHIRE&#39;, &#39;WREXHAM&#39;, &#39;HERTFORDSHIRE&#39;, &#39;PORTSMOUTH&#39;, &#39;THURROCK&#39;, &#39;CUMBRIA&#39;, &#39;SLOUGH&#39;, &#39;BRACKNELL FOREST&#39;, &#39;SOUTH GLAMORGAN&#39;, &#39;CORNWALL&#39;, &#39;CLWYD&#39;, &#39;WARRINGTON&#39;, &#39;BEDFORDSHIRE&#39;, &#39;BERKSHIRE&#39;, &#39;MID GLAMORGAN&#39;, &#39;CONWY&#39;, &#39;ISLE OF WIGHT&#39;, &#39;SOUTHAMPTON&#39;, &#39;DEVON&#39;, &#39;MILTON KEYNES&#39;, &#39;DURHAM&#39;, &#39;DYFED&#39;, &#39;POOLE&#39;, &#39;POWYS&#39;, &#39;READING&#39;, &#39;GWYNEDD&#39;, &#39;LEICESTER&#39;, &#39;RUTLAND&#39;, &#39;DORSET&#39;, &#39;CLEVELAND&#39;, &#39;DARLINGTON&#39;, &#39;THAMESDOWN&#39;, &#39;HARTLEPOOL&#39;, &#39;CARDIFF&#39;, &#39;WILTSHIRE&#39;, &#39;TORFAEN&#39;, &#39;YORK&#39;, &#39;RHONDDA CYNON TAFF&#39;, &#39;REDCAR AND CLEVELAND&#39;, &#39;TORBAY&#39;, &#39;CITY OF DERBY&#39;, &#39;CITY OF KINGSTON UPON HULL&#39;, &#39;BRIGHTON AND HOVE&#39;, &#39;BATH AND NORTH EAST SOMERSET&#39;, &#39;CITY OF PLYMOUTH&#39;, &#39;MIDDLESBROUGH&#39;, &#39;CHESHIRE EAST&#39;, &#39;MONMOUTHSHIRE&#39;, &#39;EAST RIDING OF YORKSHIRE&#39;, &#39;NORTH EAST LINCOLNSHIRE&#39;, &#39;CARMARTHENSHIRE&#39;, &#39;NORTH LINCOLNSHIRE&#39;, &#39;THE VALE OF GLAMORGAN&#39;, &#39;PEMBROKESHIRE&#39;, &#39;WEST GLAMORGAN&#39;, &#39;ISLE OF ANGLESEY&#39;, &#39;CEREDIGION&#39;, &#39;DENBIGHSHIRE&#39;, &#39;MERTHYR TYDFIL&#39;, &#39;BEDFORD&#39;, &#39;HALTON&#39;, &#39;BLACKBURN WITH DARWEN&#39;, &#39;BLAENAU GWENT&#39;, &#39;CITY OF NOTTINGHAM&#39;, &#39;CITY OF BRISTOL&#39;, &#39;CITY OF PETERBOROUGH&#39;, &#39;FLINTSHIRE&#39;, &#39;CAERPHILLY&#39;, &#39;HEREFORDSHIRE&#39;, &#39;CHESHIRE WEST AND CHESTER&#39;, &#39;SWINDON&#39;, &#39;COUNTY DURHAM&#39;, &#39;CENTRAL BEDFORDSHIRE&#39;, &#39;SOUTH GLOUCESTERSHIRE&#39;, &#39;NORTH SOMERSET&#39;, &#39;NEATH PORT TALBOT&#39;, &#39;BOURNEMOUTH, CHRISTCHURCH AND POOLE&#39;, &#39;WEST BERKSHIRE&#39;, &#39;ISLES OF SCILLY&#39;, &#39;BRIDGEND&#39;, &#39;MEDWAY&#39;, &#39;WEST NORTHAMPTONSHIRE&#39;, &#39;WREKIN&#39;, &#39;NORTH NORTHAMPTONSHIRE&#39;, &#39;WESTMORLAND AND FURNESS&#39;, &#39;CUMBERLAND&#39;]
</code></pre>
</div>
</div>
<div id="36872518" class="cell code" data-execution_count="35">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the DataFrame</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df1.copy()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define regions</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>regions <span class="op">=</span> {</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;North East England&#39;</span>: [<span class="st">&#39;TYNE AND WEAR&#39;</span>, <span class="st">&#39;NORTHUMBERLAND&#39;</span>, <span class="st">&#39;DURHAM&#39;</span>, <span class="st">&#39;HARTLEPOOL&#39;</span>, <span class="st">&#39;STOCKTON-ON-TEES&#39;</span>, <span class="st">&#39;MIDDLESBROUGH&#39;</span>, <span class="st">&#39;REDCAR AND CLEVELAND&#39;</span>, <span class="st">&#39;DARLINGTON&#39;</span>, <span class="st">&#39;CLEVELAND&#39;</span>],</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;North West England&#39;</span>: [<span class="st">&#39;CUMBRIA&#39;</span>, <span class="st">&#39;LANCASHIRE&#39;</span>, <span class="st">&#39;GREATER MANCHESTER&#39;</span>, <span class="st">&#39;MERSEYSIDE&#39;</span>, <span class="st">&#39;BLACKPOOL&#39;</span>, <span class="st">&#39;BLACKBURN WITH DARWEN&#39;</span>, <span class="st">&#39;HALTON&#39;</span>, <span class="st">&#39;WARRINGTON&#39;</span>],</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Yorkshire and the Humber&#39;</span>: [<span class="st">&#39;NORTH YORKSHIRE&#39;</span>, <span class="st">&#39;WEST YORKSHIRE&#39;</span>, <span class="st">&#39;SOUTH YORKSHIRE&#39;</span>, <span class="st">&#39;EAST RIDING OF YORKSHIRE&#39;</span>, <span class="st">&#39;HUMBERSIDE&#39;</span>, <span class="st">&#39;CITY OF KINGSTON UPON HULL&#39;</span>, <span class="st">&#39;YORK&#39;</span>],</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;East Midlands&#39;</span>: [<span class="st">&#39;DERBYSHIRE&#39;</span>, <span class="st">&#39;LEICESTERSHIRE&#39;</span>, <span class="st">&#39;LINCOLNSHIRE&#39;</span>, <span class="st">&#39;NORTHAMPTONSHIRE&#39;</span>, <span class="st">&#39;NOTTINGHAMSHIRE&#39;</span>, <span class="st">&#39;RUTLAND&#39;</span>, <span class="st">&#39;CITY OF DERBY&#39;</span>, <span class="st">&#39;CITY OF NOTTINGHAM&#39;</span>, <span class="st">&#39;LEICESTER&#39;</span>],</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;West Midlands&#39;</span>: [<span class="st">&#39;SHROPSHIRE&#39;</span>, <span class="st">&#39;STAFFORDSHIRE&#39;</span>, <span class="st">&#39;WEST MIDLANDS&#39;</span>, <span class="st">&#39;WARWICKSHIRE&#39;</span>, <span class="st">&#39;WORCESTERSHIRE&#39;</span>, <span class="st">&#39;HEREFORDSHIRE&#39;</span>, <span class="st">&#39;WREKIN&#39;</span>],</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;East of England&#39;</span>: [<span class="st">&#39;BEDFORDSHIRE&#39;</span>, <span class="st">&#39;CAMBRIDGESHIRE&#39;</span>, <span class="st">&#39;ESSEX&#39;</span>, <span class="st">&#39;HERTFORDSHIRE&#39;</span>, <span class="st">&#39;NORFOLK&#39;</span>, <span class="st">&#39;SUFFOLK&#39;</span>, <span class="st">&#39;CITY OF PETERBOROUGH&#39;</span>, <span class="st">&#39;THURROCK&#39;</span>, <span class="st">&#39;SOUTHEND-ON-SEA&#39;</span>],</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;London&#39;</span>: [<span class="st">&#39;GREATER LONDON&#39;</span>],</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;South East England&#39;</span>: [<span class="st">&#39;BERKSHIRE&#39;</span>, <span class="st">&#39;BUCKINGHAMSHIRE&#39;</span>, <span class="st">&#39;EAST SUSSEX&#39;</span>, <span class="st">&#39;HAMPSHIRE&#39;</span>, <span class="st">&#39;KENT&#39;</span>, <span class="st">&#39;OXFORDSHIRE&#39;</span>, <span class="st">&#39;SURREY&#39;</span>, <span class="st">&#39;WEST SUSSEX&#39;</span>, <span class="st">&#39;MILTON KEYNES&#39;</span>, <span class="st">&#39;PORTSMOUTH&#39;</span>, <span class="st">&#39;SOUTHAMPTON&#39;</span>, <span class="st">&#39;ISLE OF WIGHT&#39;</span>, <span class="st">&#39;BRACKNELL FOREST&#39;</span>, <span class="st">&#39;WOKINGHAM&#39;</span>, <span class="st">&#39;WINDSOR AND MAIDENHEAD&#39;</span>, <span class="st">&#39;SLOUGH&#39;</span>, <span class="st">&#39;MEDWAY&#39;</span>, <span class="st">&#39;BRIGHTON AND HOVE&#39;</span>],</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;South West England&#39;</span>: [<span class="st">&#39;DORSET&#39;</span>, <span class="st">&#39;SOMERSET&#39;</span>, <span class="st">&#39;CORNWALL&#39;</span>, <span class="st">&#39;DEVON&#39;</span>, <span class="st">&#39;GLOUCESTERSHIRE&#39;</span>, <span class="st">&#39;WILTSHIRE&#39;</span>, <span class="st">&#39;BATH AND NORTH EAST SOMERSET&#39;</span>, <span class="st">&#39;BOURNEMOUTH, CHRISTCHURCH AND POOLE&#39;</span>, <span class="st">&#39;CITY OF BRISTOL&#39;</span>, <span class="st">&#39;SOUTH GLOUCESTERSHIRE&#39;</span>, <span class="st">&#39;NORTH SOMERSET&#39;</span>, <span class="st">&#39;PLYMOUTH&#39;</span>, <span class="st">&#39;TORBAY&#39;</span>, <span class="st">&#39;SWINDON&#39;</span>, <span class="st">&#39;ISLES OF SCILLY&#39;</span>],</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Wales&#39;</span>: [<span class="st">&#39;ISLE OF ANGLESEY&#39;</span>, <span class="st">&#39;BRECONSHIRE&#39;</span>, <span class="st">&#39;CAERNARFONSHIRE&#39;</span>, <span class="st">&#39;CARDIFF&#39;</span>, <span class="st">&#39;CARMARTHENSHIRE&#39;</span>, <span class="st">&#39;CEREDIGION&#39;</span>, <span class="st">&#39;CLWYD&#39;</span>, <span class="st">&#39;CONWY&#39;</span>, <span class="st">&#39;DENBIGHSHIRE&#39;</span>, <span class="st">&#39;DYFED&#39;</span>, <span class="st">&#39;FLINTSHIRE&#39;</span>, <span class="st">&#39;GLAMORGAN&#39;</span>, <span class="st">&#39;GWENT&#39;</span>, <span class="st">&#39;GWYNEDD&#39;</span>, <span class="st">&#39;MERTHYR TYDFIL&#39;</span>, <span class="st">&#39;MONMOUTHSHIRE&#39;</span>, <span class="st">&#39;NEATH PORT TALBOT&#39;</span>, <span class="st">&#39;NEWPORT&#39;</span>, <span class="st">&#39;PEMBROKESHIRE&#39;</span>, <span class="st">&#39;POWYS&#39;</span>, <span class="st">&#39;RHONDDA CYNON TAFF&#39;</span>, <span class="st">&#39;SWANSEA&#39;</span>, <span class="st">&#39;TORFAEN&#39;</span>, <span class="st">&#39;VALE OF GLAMORGAN&#39;</span>, <span class="st">&#39;WREXHAM&#39;</span>],</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Scotland&#39;</span>: [],  <span class="co"># No counties listed for Scotland in your provided list</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Northern Ireland&#39;</span>: [],  <span class="co"># No counties listed for Northern Ireland in your provided list</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the regions dictionary for easy lookup</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>county_to_region <span class="op">=</span> {county: region <span class="cf">for</span> region, counties <span class="kw">in</span> regions.items() <span class="cf">for</span> county <span class="kw">in</span> counties}</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to classify the county into regions</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classify_county(county):</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> county_to_region.get(county, <span class="st">&#39;Unknown&#39;</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to classify counties into regions</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;Region&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;County&#39;</span>].<span class="bu">apply</span>(classify_county)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the DataFrame to verify the changes</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df2[[<span class="st">&#39;County&#39;</span>, <span class="st">&#39;Region&#39;</span>]])</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>                   County                    Region
0           TYNE AND WEAR        North East England
1                   ESSEX           East of England
2           WEST MIDLANDS             West Midlands
3           WEST MIDLANDS             West Midlands
4         SOUTH YORKSHIRE  Yorkshire and the Humber
...                   ...                       ...
28230253   GREATER LONDON                    London
28230254  SOUTHEND-ON-SEA           East of England
28230255            ESSEX           East of England
28230256            ESSEX           East of England
28230257            ESSEX           East of England

[28230258 rows x 2 columns]
</code></pre>
</div>
</div>
<div id="f342a4b5" class="cell code" data-execution_count="36">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df2.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="36">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Transaction_unique_identifier</th>
      <th>Price</th>
      <th>Date_of_Transfer</th>
      <th>Postcode</th>
      <th>Property_Type</th>
      <th>Old/New</th>
      <th>Duration</th>
      <th>PAON</th>
      <th>SAON</th>
      <th>Street</th>
      <th>...</th>
      <th>Town/City</th>
      <th>District</th>
      <th>County</th>
      <th>Transaction_type</th>
      <th>Record_status</th>
      <th>Date</th>
      <th>Day</th>
      <th>Month</th>
      <th>Year</th>
      <th>Region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>{40FD4DF2-5362-407C-92BC-566E2CCE89E9}</td>
      <td>44500</td>
      <td>1995-02-03</td>
      <td>SR6 0AQ</td>
      <td>T</td>
      <td>N</td>
      <td>F</td>
      <td>50</td>
      <td>Unknown</td>
      <td>HOWICK PARK</td>
      <td>...</td>
      <td>SUNDERLAND</td>
      <td>SUNDERLAND</td>
      <td>TYNE AND WEAR</td>
      <td>A</td>
      <td>A</td>
      <td>1995-02-03</td>
      <td>3</td>
      <td>2</td>
      <td>1995</td>
      <td>North East England</td>
    </tr>
    <tr>
      <th>1</th>
      <td>{7A99F89E-7D81-4E45-ABD5-566E49A045EA}</td>
      <td>56500</td>
      <td>1995-01-13</td>
      <td>CO6 1SQ</td>
      <td>T</td>
      <td>N</td>
      <td>F</td>
      <td>19</td>
      <td>Unknown</td>
      <td>BRICK KILN CLOSE</td>
      <td>...</td>
      <td>COLCHESTER</td>
      <td>BRAINTREE</td>
      <td>ESSEX</td>
      <td>A</td>
      <td>A</td>
      <td>1995-01-13</td>
      <td>13</td>
      <td>1</td>
      <td>1995</td>
      <td>East of England</td>
    </tr>
    <tr>
      <th>2</th>
      <td>{28225260-E61C-4E57-8B56-566E5285B1C1}</td>
      <td>58000</td>
      <td>1995-07-28</td>
      <td>B90 4TG</td>
      <td>T</td>
      <td>N</td>
      <td>F</td>
      <td>37</td>
      <td>Unknown</td>
      <td>RAINSBROOK DRIVE</td>
      <td>...</td>
      <td>SOLIHULL</td>
      <td>SOLIHULL</td>
      <td>WEST MIDLANDS</td>
      <td>A</td>
      <td>A</td>
      <td>1995-07-28</td>
      <td>28</td>
      <td>7</td>
      <td>1995</td>
      <td>West Midlands</td>
    </tr>
    <tr>
      <th>3</th>
      <td>{444D34D7-9BA6-43A7-B695-4F48980E0176}</td>
      <td>51000</td>
      <td>1995-06-28</td>
      <td>DY5 1SA</td>
      <td>S</td>
      <td>N</td>
      <td>F</td>
      <td>59</td>
      <td>Unknown</td>
      <td>MERRY HILL</td>
      <td>...</td>
      <td>BRIERLEY HILL</td>
      <td>DUDLEY</td>
      <td>WEST MIDLANDS</td>
      <td>A</td>
      <td>A</td>
      <td>1995-06-28</td>
      <td>28</td>
      <td>6</td>
      <td>1995</td>
      <td>West Midlands</td>
    </tr>
    <tr>
      <th>4</th>
      <td>{AE76CAF1-F8CC-43F9-8F63-4F48A2857D41}</td>
      <td>17000</td>
      <td>1995-03-10</td>
      <td>S65 1QJ</td>
      <td>T</td>
      <td>N</td>
      <td>L</td>
      <td>22</td>
      <td>Unknown</td>
      <td>DENMAN STREET</td>
      <td>...</td>
      <td>ROTHERHAM</td>
      <td>ROTHERHAM</td>
      <td>SOUTH YORKSHIRE</td>
      <td>A</td>
      <td>A</td>
      <td>1995-03-10</td>
      <td>10</td>
      <td>3</td>
      <td>1995</td>
      <td>Yorkshire and the Humber</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<div id="3573171a" class="cell code">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Entries were rename to provide ration based on reseach from ONS website</span></span></code></pre></div>
</div>
<div id="7bd1e586" class="cell code" data-execution_count="38">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining property type mapping</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;Property_Type&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;Property_Type&#39;</span>].<span class="bu">map</span>({</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;O&#39;</span>: <span class="st">&#39;Other&#39;</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;F&#39;</span>: <span class="st">&#39;Flat/Maisonette&#39;</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;D&#39;</span>: <span class="st">&#39;Detached&#39;</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;S&#39;</span>: <span class="st">&#39;Semi-detached&#39;</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;T&#39;</span>: <span class="st">&#39;Terraced&#39;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Map the values based on ONS research</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;Transaction_type&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;Transaction_type&#39;</span>].<span class="bu">map</span>({</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;A&#39;</span>: <span class="st">&#39;Standard Price Paid entry&#39;</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;B&#39;</span>: <span class="st">&#39;Additional Price Paid entry (includes transactions under specific conditions like repossessions, buy-to-let, etc.)&#39;</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;Record_status&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;Record_status&#39;</span>].<span class="bu">map</span>({</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;A&#39;</span>: <span class="st">&#39;Add (a new entry)&#39;</span>,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;C&#39;</span>: <span class="st">&#39;Change (an amendment to an entry)&#39;</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;D&#39;</span>: <span class="st">&#39;Delete (a deletion of an entry)&#39;</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming &#39;Duration&#39; column &#39;F&#39; and &#39;L&#39; for Freehold and Leasehold based on ONS research</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;Duration&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;Duration&#39;</span>].<span class="bu">map</span>({</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;F&#39;</span>: <span class="st">&#39;Freehold&#39;</span>,</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;L&#39;</span>: <span class="st">&#39;Leasehold&#39;</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename entries in &#39;Old/New&#39; column</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;Old/New&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;Old/New&#39;</span>].<span class="bu">map</span>({</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;N&#39;</span>: <span class="st">&#39;New&#39;</span>,</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Y&#39;</span>: <span class="st">&#39;Old&#39;</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="co"># List of relevant columns including the renamed ones</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>columns_of_interest <span class="op">=</span> [</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Duration&#39;</span>, <span class="st">&#39;Property_Type&#39;</span>, <span class="st">&#39;County&#39;</span>, <span class="st">&#39;District&#39;</span>, <span class="st">&#39;Town/City&#39;</span>, <span class="st">&#39;Postcode&#39;</span>, </span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Transaction_type&#39;</span>, <span class="st">&#39;Record_status&#39;</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows to verify the changes</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>df2.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="38">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Transaction_unique_identifier</th>
      <th>Price</th>
      <th>Date_of_Transfer</th>
      <th>Postcode</th>
      <th>Property_Type</th>
      <th>Old/New</th>
      <th>Duration</th>
      <th>PAON</th>
      <th>SAON</th>
      <th>Street</th>
      <th>...</th>
      <th>Town/City</th>
      <th>District</th>
      <th>County</th>
      <th>Transaction_type</th>
      <th>Record_status</th>
      <th>Date</th>
      <th>Day</th>
      <th>Month</th>
      <th>Year</th>
      <th>Region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>{40FD4DF2-5362-407C-92BC-566E2CCE89E9}</td>
      <td>44500</td>
      <td>1995-02-03</td>
      <td>SR6 0AQ</td>
      <td>Terraced</td>
      <td>New</td>
      <td>Freehold</td>
      <td>50</td>
      <td>Unknown</td>
      <td>HOWICK PARK</td>
      <td>...</td>
      <td>SUNDERLAND</td>
      <td>SUNDERLAND</td>
      <td>TYNE AND WEAR</td>
      <td>Standard Price Paid entry</td>
      <td>Add (a new entry)</td>
      <td>1995-02-03</td>
      <td>3</td>
      <td>2</td>
      <td>1995</td>
      <td>North East England</td>
    </tr>
    <tr>
      <th>1</th>
      <td>{7A99F89E-7D81-4E45-ABD5-566E49A045EA}</td>
      <td>56500</td>
      <td>1995-01-13</td>
      <td>CO6 1SQ</td>
      <td>Terraced</td>
      <td>New</td>
      <td>Freehold</td>
      <td>19</td>
      <td>Unknown</td>
      <td>BRICK KILN CLOSE</td>
      <td>...</td>
      <td>COLCHESTER</td>
      <td>BRAINTREE</td>
      <td>ESSEX</td>
      <td>Standard Price Paid entry</td>
      <td>Add (a new entry)</td>
      <td>1995-01-13</td>
      <td>13</td>
      <td>1</td>
      <td>1995</td>
      <td>East of England</td>
    </tr>
    <tr>
      <th>2</th>
      <td>{28225260-E61C-4E57-8B56-566E5285B1C1}</td>
      <td>58000</td>
      <td>1995-07-28</td>
      <td>B90 4TG</td>
      <td>Terraced</td>
      <td>New</td>
      <td>Freehold</td>
      <td>37</td>
      <td>Unknown</td>
      <td>RAINSBROOK DRIVE</td>
      <td>...</td>
      <td>SOLIHULL</td>
      <td>SOLIHULL</td>
      <td>WEST MIDLANDS</td>
      <td>Standard Price Paid entry</td>
      <td>Add (a new entry)</td>
      <td>1995-07-28</td>
      <td>28</td>
      <td>7</td>
      <td>1995</td>
      <td>West Midlands</td>
    </tr>
    <tr>
      <th>3</th>
      <td>{444D34D7-9BA6-43A7-B695-4F48980E0176}</td>
      <td>51000</td>
      <td>1995-06-28</td>
      <td>DY5 1SA</td>
      <td>Semi-detached</td>
      <td>New</td>
      <td>Freehold</td>
      <td>59</td>
      <td>Unknown</td>
      <td>MERRY HILL</td>
      <td>...</td>
      <td>BRIERLEY HILL</td>
      <td>DUDLEY</td>
      <td>WEST MIDLANDS</td>
      <td>Standard Price Paid entry</td>
      <td>Add (a new entry)</td>
      <td>1995-06-28</td>
      <td>28</td>
      <td>6</td>
      <td>1995</td>
      <td>West Midlands</td>
    </tr>
    <tr>
      <th>4</th>
      <td>{AE76CAF1-F8CC-43F9-8F63-4F48A2857D41}</td>
      <td>17000</td>
      <td>1995-03-10</td>
      <td>S65 1QJ</td>
      <td>Terraced</td>
      <td>New</td>
      <td>Leasehold</td>
      <td>22</td>
      <td>Unknown</td>
      <td>DENMAN STREET</td>
      <td>...</td>
      <td>ROTHERHAM</td>
      <td>ROTHERHAM</td>
      <td>SOUTH YORKSHIRE</td>
      <td>Standard Price Paid entry</td>
      <td>Add (a new entry)</td>
      <td>1995-03-10</td>
      <td>10</td>
      <td>3</td>
      <td>1995</td>
      <td>Yorkshire and the Humber</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<div id="699b5c05" class="cell code" data-execution_count="40"
data-scrolled="true">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>entry_counts <span class="op">=</span> df2.count()</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(entry_counts)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Transaction_unique_identifier    28230258
Price                            28230258
Date_of_Transfer                 28230258
Postcode                         28230258
Property_Type                    28230258
Old/New                          28230258
Duration                         28229725
PAON                             28226070
SAON                             28230258
Street                           28230258
Locality                         28230258
Town/City                        28230258
District                         28230258
County                           28230258
Transaction_type                 28230258
Record_status                    28230258
Date                             28230258
Day                              28230258
Month                            28230258
Year                             28230258
Region                           28230258
dtype: int64
</code></pre>
</div>
</div>
<div id="2de1eb87" class="cell code">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking if changes was successfull</span></span></code></pre></div>
</div>
<div id="85e4f21c" class="cell code" data-execution_count="44"
data-scrolled="true">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List of relevant columns including the renamed ones</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>columns_of_interest <span class="op">=</span> [</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Duration&#39;</span>, <span class="st">&#39;Property_Type&#39;</span>, <span class="st">&#39;County&#39;</span>, <span class="st">&#39;District&#39;</span>, <span class="st">&#39;Town/City&#39;</span>, <span class="st">&#39;Postcode&#39;</span>, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Transaction_type&#39;</span>, <span class="st">&#39;Record_status&#39;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure all columns exist in the DataFrame before counting unique values</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>existing_columns_of_interest <span class="op">=</span> [column <span class="cf">for</span> column <span class="kw">in</span> columns_of_interest <span class="cf">if</span> column <span class="kw">in</span> df2.columns]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the unique values for each relevant column</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>unique_counts <span class="op">=</span> {column: df2[column].nunique() <span class="cf">for</span> column <span class="kw">in</span> existing_columns_of_interest}</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the unique counts</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column, count <span class="kw">in</span> unique_counts.items():</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>column<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>count<span class="sc">}</span><span class="ss"> unique values&quot;</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># List the unique values for &#39;Transaction_type&#39;, &#39;Record_status&#39;, and &#39;Duration&#39; if they exist</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>transaction_type_unique <span class="op">=</span> df2[<span class="st">&#39;Transaction_type&#39;</span>].unique() <span class="cf">if</span> <span class="st">&#39;Transaction_type&#39;</span> <span class="kw">in</span> df2.columns <span class="cf">else</span> []</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>record_status_unique <span class="op">=</span> df2[<span class="st">&#39;Record_status&#39;</span>].unique() <span class="cf">if</span> <span class="st">&#39;Record_status&#39;</span> <span class="kw">in</span> df2.columns <span class="cf">else</span> []</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>duration_unique <span class="op">=</span> df2[<span class="st">&#39;Duration&#39;</span>].unique() <span class="cf">if</span> <span class="st">&#39;Duration&#39;</span> <span class="kw">in</span> df2.columns <span class="cf">else</span> []</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Unique values for &#39;Transaction_type&#39;:&quot;</span>, transaction_type_unique)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Unique values for &#39;Record_status&#39;:&quot;</span>, record_status_unique)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Unique values for &#39;Duration&#39;:&quot;</span>, duration_unique)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Duration: 2 unique values
Property_Type: 5 unique values
County: 132 unique values
District: 467 unique values
Town/City: 1172 unique values
Postcode: 1296549 unique values
Transaction_type: 2 unique values
Record_status: 1 unique values

Unique values for &#39;Transaction_type&#39;: [&#39;Standard Price Paid entry&#39;
 &#39;Additional Price Paid entry (includes transactions under specific conditions like repossessions, buy-to-let, etc.)&#39;]
Unique values for &#39;Record_status&#39;: [&#39;Add (a new entry)&#39;]
Unique values for &#39;Duration&#39;: [&#39;Freehold&#39; &#39;Leasehold&#39; nan]
</code></pre>
</div>
</div>
<div id="2f46d0b9" class="cell code" data-execution_count="46"
data-scrolled="true">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>df2.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 28230258 entries, 0 to 28230257
Data columns (total 21 columns):
 #   Column                         Dtype         
---  ------                         -----         
 0   Transaction_unique_identifier  object        
 1   Price                          int64         
 2   Date_of_Transfer               datetime64[ns]
 3   Postcode                       object        
 4   Property_Type                  object        
 5   Old/New                        object        
 6   Duration                       object        
 7   PAON                           object        
 8   SAON                           object        
 9   Street                         object        
 10  Locality                       object        
 11  Town/City                      object        
 12  District                       object        
 13  County                         object        
 14  Transaction_type               object        
 15  Record_status                  object        
 16  Date                           object        
 17  Day                            int32         
 18  Month                          int32         
 19  Year                           int32         
 20  Region                         object        
dtypes: datetime64[ns](1), int32(3), int64(1), object(16)
memory usage: 4.1+ GB
</code></pre>
</div>
</div>
<div id="f762b88d" class="cell code" data-execution_count="50">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Saving data frame as csv for analysis</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Save df2 to a CSV file</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>df2.to_csv(<span class="st">&#39;Housing_Uk.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Provide the download link</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The DataFrame has been saved to &#39;Housing_Uk.csv&#39;.&quot;</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>The DataFrame has been saved to &#39;Housing_Uk.csv&#39;.
</code></pre>
</div>
</div>
<div id="eefcae2b" class="cell code">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="ee7a4b40" class="cell code">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="9c9e7b5d" class="cell code">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="09fe8b16" class="cell code">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="14e35b92" class="cell code">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="9e5ae84f" class="cell code">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="c6c55215" class="cell code">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="4f0421a2" class="cell code">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="6cf9fb60" class="cell code">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
